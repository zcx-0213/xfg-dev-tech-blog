<img src="https://mmbiz.qpic.cn/mmbiz_png/RXvHpViaz3EozrV0KJDBlyZ3dH8NBBH1YvlySHf3wnCtdbvSDx4JBV4YJJuXbvrF1DXmN3hMLBcHLGvOk4zFTEA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片" style="zoom:50%;" />

1. # 分布式系统服务

2. 服务注册与发现  基本原理

   - 服务注册：服务进程可以在注册中心注册自己的元数据信息：包括主机和端口号，有时候还有身份验证信息，协议，版本号，运行环境的信息
   - 服务发现：客户端服务进程，向注册中心查询；获取服务信息；就是给客户端提供一个服务列表 

3. 服务注册

   - 客户端注册：是服务自己负责注册和注销的工作；缺点就是服务管理和 业务逻辑本身耦合在一起，不好管理和扩展
   - 代理注册：由一个单独的代理进行注册和注销；服务启动之后，以某种形式通知代理服务；然后代理向注册中心发起注册服务

4. 服务发现：

   - 客户端发现：就是客户端向注册中心请求服务列表；获取所有的可用实例地址列表 然后根据负载均衡算法选择一个实例发起请求
   - 缺点：负载均衡算法、获取实例地址、与服务的业务逻辑耦合，负载均衡有变化，所有服务都要从新修改上线
   - 代理发现：新增一个路由服务；配置好的负载均衡算法从可用的实例列表中选择一个实例将请求转发过去即可，如果发现实例不可用，路由服务还可以自行重试，服务消费者完全不用感知。

5. 心跳机制：

6. ![image-20240725194919449](C:\Users\王冉\AppData\Roaming\Typora\typora-user-images\image-20240725194919449.png)

# Dubbo

1. 使微服务各个模块之间高效的通信（RPC）：用户、支付、商品、配送、活动、风控等各个模块

2. 通信：引入了RPC框架，Dubbo就是Rpc框架的实现之一

3. 那为啥用 Dubbo 呢？其实核心问题就一个，为了提高通信效率。**因为 Dubbo 的底层通信是 Socket 而不是 HTTP 所以通信的性能会更好。同时 Dubbo 又有分布式的高可用设计**，在一组部署了交易服务的实例宕机后，会被从注册中心摘除，之后流量会打到其他服务上。

4. <img src="https://bugstack.cn/images/roadmap/tutorial/roadmap-dubbo-02.png?raw=true" alt="img" style="zoom:50%;" />

5. 细节1：Dubbo的出入参数都要实现序列化接口，继承 Serializable 接口， UserReqDTO、UserResDTO、Response 这3个类，都得继承 Serializable 序列化接口

   1. 细节2：Dubbo 的实现接口，都被Dubbo自己管理；所以 Dubbo 提供了 @DubboService 注解。

   2. 细节3：base-packages 扫描的是哪里配置了 Dubbo 的 API 入口，给它入口就行，它会自己找到实现类。

   3. 细节4：Spring 应用开发，讲究约定大于配置。你 Application 应用的包名，应该是可以覆盖到其他包名的。

   4. 你有2个应用，一个Dubbo接口提供方、一个Dubbo接口使用方。那么你在给你另外一个应用使用接口的时候，你在 InelliJ IDEA 的 Maven 中执行 Install 了吗？

   5. Install 是干啥的？它是为了让你使用了同一个本地 Maven 配置的应用，可以引入到对方提供的 Jar 包。你 Install 以后，这个 Jar 包就会进入到本地 Maven 仓库了。如果是公司里开发，会有专门的自己家部署的，私有Maven中心仓库，就可以通过 deploy 把本地 Jar 发布上去，那么公司里的伙伴，也就都可以引用了。

   6. 接口使用方：

      1. 利用POM引入，POM 的配置，就是把 Jar 包给引用进来。因为 Dubbo 需要根据这个接口，做一个代理操作。**不引入，你代码就爆红啦！爆红啦！🌶**

      2. ```
         1. 1. 1. <dependency>
                      <groupId>cn.bugstack</groupId>
                      <artifactId>xfg-dev-tech-dubbo-api</artifactId>
                      <version>1.0-SNAPSHOT</version>
                  </dependency>
         
         
         ```

         